{
    "builders": [
        {
            "type": "azure-arm",
            "managed_image_resource_group_name": "{{ user `rg_name` }}",
            "managed_image_name": "{{ user `image_name_prefix` }}_vm_base_image_v{{user `version` }}",
            "build_resource_group_name": "{{ user `rg_name` }}",
            "virtual_network_resource_group_name": "{{ user `vnet_rg_name` }}",
            "virtual_network_name": "{{ user `vnet_name` }}",
            "virtual_network_subnet_name": "{{ user `vnet_subnet_name` }}",
            "vm_size": "{{ user `builder_vm_size` }}",

            "os_type": "Linux",
            "image_publisher": "Canonical",
            "image_offer": "UbuntuServer",
            "image_sku": "18.04-LTS"
        }
    ],
    "provisioners": [
        {
            "type": "shell",
            "script": "./scripts/setup.sh"
        },
        {
            "type": "ansible-local",
            "playbook_file": "./ansible/main.yml",
            "role_paths": [
                "./ansible/roles/environment-modules",
                "./ansible/roles/gcc-10.1.0",
                "./ansible/roles/openmpi-4.0.3"
            ],
            "group_vars": "./ansible/group_vars"
        },
        {
            "type": "shell",
            "script": "./scripts/cleanup.sh"
        }
    ]
}